<!doctype html>
<html lang="zh"><head><meta name="baidu-site-verification" content="codeva-UlX0cGL1PK"><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta><title>基于vue+django开发的网络设备轻量化管理平台NetOpsCenter - BG4VRG的无线电之旅</title><link rel="manifest" href="/manifest.json"><meta name="application-name" content="BG4VRG的无线电之旅"><meta name="msapplication-TileImage" content="/img/freebsd.svg"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-title" content="BG4VRG的无线电之旅"><meta name="apple-mobile-web-app-status-bar-style" content="default"><meta name="description" content="项目地址：https:&amp;#x2F;&amp;#x2F;github.com&amp;#x2F;XiuziSeven&amp;#x2F;NetOpsCenter 作者写的介绍：https:&amp;#x2F;&amp;#x2F;zhuanlan.zhihu.com&amp;#x2F;p&amp;#x2F;655040014 因为代码中backuponfig.py中相关备份路径默认是linux下路径方式，且使用了windows下没有的mkdir命令，所以导致windows中备份配置时会显示失败。 这也是为什么有了这篇文章的原因。"><meta property="og:type" content="blog"><meta property="og:title" content="基于vue+django开发的网络设备轻量化管理平台NetOpsCenter"><meta property="og:url" content="https://bg4vrg.com/post/20240418192744.html"><meta property="og:site_name" content="BG4VRG的无线电之旅"><meta property="og:description" content="项目地址：https:&amp;#x2F;&amp;#x2F;github.com&amp;#x2F;XiuziSeven&amp;#x2F;NetOpsCenter 作者写的介绍：https:&amp;#x2F;&amp;#x2F;zhuanlan.zhihu.com&amp;#x2F;p&amp;#x2F;655040014 因为代码中backuponfig.py中相关备份路径默认是linux下路径方式，且使用了windows下没有的mkdir命令，所以导致windows中备份配置时会显示失败。 这也是为什么有了这篇文章的原因。"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="https://bg4vrg.com/pic/2024-4-18-netopscenter-1.png"><meta property="og:image" content="https://bg4vrg.com/pic/2024-4-18-netopscenter-2.png"><meta property="og:image" content="https://bg4vrg.com/pic/2024-4-18-netopscenter-3.png"><meta property="og:image" content="https://bg4vrg.com/pic/2024-4-18-netopscenter-4.png"><meta property="article:published_time" content="2024-04-18T11:27:44.000Z"><meta property="article:modified_time" content="2024-05-22T05:01:09.236Z"><meta property="article:author" content="fei"><meta property="article:tag" content="网络"><meta property="article:tag" content="折腾"><meta property="article:tag" content="linux"><meta property="twitter:card" content="summary"><meta property="twitter:image:src" content="https://bg4vrg.com/pic/2024-4-18-netopscenter-1.png"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://bg4vrg.com/post/20240418192744.html"},"headline":"基于vue+django开发的网络设备轻量化管理平台NetOpsCenter","image":["https://bg4vrg.com/pic/2024-4-18-netopscenter-1.png","https://bg4vrg.com/pic/2024-4-18-netopscenter-2.png","https://bg4vrg.com/pic/2024-4-18-netopscenter-3.png","https://bg4vrg.com/pic/2024-4-18-netopscenter-4.png"],"datePublished":"2024-04-18T11:27:44.000Z","dateModified":"2024-05-22T05:01:09.236Z","author":{"@type":"Person","name":"fei"},"publisher":{"@type":"Organization","name":"BG4VRG的无线电之旅","logo":{"@type":"ImageObject","url":"https://bg4vrg.com/img/freebsd.svg"}},"description":"项目地址：https:&#x2F;&#x2F;github.com&#x2F;XiuziSeven&#x2F;NetOpsCenter 作者写的介绍：https:&#x2F;&#x2F;zhuanlan.zhihu.com&#x2F;p&#x2F;655040014 因为代码中backuponfig.py中相关备份路径默认是linux下路径方式，且使用了windows下没有的mkdir命令，所以导致windows中备份配置时会显示失败。 这也是为什么有了这篇文章的原因。"}</script><link rel="canonical" href="https://bg4vrg.com/post/20240418192744.html"><link rel="alternate" href="/atom.xml" title="BG4VRG的无线电之旅" type="application/atom+xml"><link rel="icon" href="/img/freebsd.svg"><link rel="stylesheet" href="https://use.fontawesome.com/releases/v6.0.0/css/all.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@11.7.0/styles/atom-one-light.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Ubuntu:wght@400;600&amp;family=Source+Code+Pro"><link rel="stylesheet" href="/css/default.css"><style>body>.footer,body>.navbar,body>.section{opacity:0}</style><!--!--><!--!--><script src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" defer></script><!--!--><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@1.10.0/dist/css/lightgallery.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/justifiedGallery@3.8.1/dist/css/justifiedGallery.min.css"><!--!--><!--!--><style>.pace{-webkit-pointer-events:none;pointer-events:none;-webkit-user-select:none;-moz-user-select:none;user-select:none}.pace-inactive{display:none}.pace .pace-progress{background:#3273dc;position:fixed;z-index:2000;top:0;right:100%;width:100%;height:2px}</style><script src="https://cdn.jsdelivr.net/npm/pace-js@1.2.4/pace.min.js"></script><!--!--><!--!--><script data-ad-client="ca-pub-1305232905963539" src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js" async></script><!-- hexo injector head_end start --><script>
  (function () {
      function switchTab() {
          if (!location.hash) {
            return;
          }

          const id = '#' + CSS.escape(location.hash.substring(1));
          const $tabMenu = document.querySelector(`.tabs a[href="${id}"]`);
          if (!$tabMenu) {
            return;
          }

          const $tabMenuContainer = $tabMenu.parentElement.parentElement;
          Array.from($tabMenuContainer.children).forEach($menu => $menu.classList.remove('is-active'));
          Array.from($tabMenuContainer.querySelectorAll('a'))
              .map($menu => document.getElementById($menu.getAttribute("href").substring(1)))
              .forEach($content => $content.classList.add('is-hidden'));

          if ($tabMenu) {
              $tabMenu.parentElement.classList.add('is-active');
          }
          const $activeTab = document.querySelector(id);
          if ($activeTab) {
              $activeTab.classList.remove('is-hidden');
          }
      }
      switchTab();
      window.addEventListener('hashchange', switchTab, false);
  })();
  </script><!-- hexo injector head_end end --><meta name="generator" content="Hexo 6.3.0"></head><body class="is-3-column"><nav class="navbar navbar-main"><div class="container navbar-container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/"><img src="/img/freebsd.svg" alt="BG4VRG的无线电之旅" height="28"></a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item" href="/">首页</a><a class="navbar-item" href="/archives">归档</a><a class="navbar-item" href="/categories">分类</a><a class="navbar-item" href="/tags">标签</a><a class="navbar-item" href="/about">关于</a><a class="navbar-item" href="/categories/AmateurRadio">业余无线电</a><a class="navbar-item" href="/categories/network">网络</a><a class="navbar-item" href="/categories/linux">Linux</a></div><div class="navbar-end"><a class="navbar-item" target="_blank" rel="external nofollow noopener noreferrer" title="Download on GitHub" href="https://github.com/ppoffice/hexo-theme-icarus"><i class="fab fa-github"></i></a><a class="navbar-item is-hidden-tablet catalogue" title="目录" href="javascript:;" rel="external nofollow noreferrer"><i class="fas fa-list-ul"></i></a><a class="navbar-item search" title="搜索" href="javascript:;" rel="external nofollow noreferrer"><i class="fas fa-search"></i></a></div></div></div></nav><br><center><span id="jinrishici-sentence" style="font-size:17px">正在加载今日诗词....</span><span class="mtip" style="font-size:14px"></span></center><script src="https://sdk.jinrishici.com/v2/browser/jinrishici.js" charset="utf-8"></script><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-8-tablet is-8-desktop is-9-widescreen"><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time datetime="2024-04-18T11:27:44.000Z" title="2024/4/18 19:27:44">2024-04-18</time>发表</span><span class="level-item"><time datetime="2024-05-22T05:01:09.236Z" title="2024/5/22 13:01:09">2024-05-22</time>更新</span><span class="level-item"><a class="link-muted" href="/categories/network/">网络</a></span><span class="level-item">12 分钟读完 (大约1730个字)</span><span class="level-item" id="busuanzi_container_page_pv"><span id="busuanzi_value_page_pv">0</span>次访问</span></div></div><h1 class="title is-3 is-size-4-mobile">基于vue+django开发的网络设备轻量化管理平台NetOpsCenter</h1><div class="content"><p>项目地址：<a target="_blank" rel="external nofollow noopener noreferrer" href="https://github.com/XiuziSeven/NetOpsCenter">https://github.com/XiuziSeven/NetOpsCenter</a></p>
<p>作者写的介绍：<a target="_blank" rel="external nofollow noopener noreferrer" href="https://zhuanlan.zhihu.com/p/655040014">https://zhuanlan.zhihu.com/p/655040014</a></p>
<p>因为代码中backuponfig.py中相关备份路径默认是linux下路径方式，且使用了windows下没有的mkdir命令，所以导致windows中备份配置时会显示失败。</p>
<p>这也是为什么有了这篇文章的原因。</p>
<p><img src="/../pic/2024-4-18-netopscenter-1.png"></p>
<span id="more"></span>

<p>python环境搭建见上一篇文章。</p>
<p>centos7 最小化安装,所以后面会因为缺少组件导致报错。</p>
<h1 id="一、创建虚拟环境"><a href="#一、创建虚拟环境" class="headerlink" title="一、创建虚拟环境"></a>一、创建虚拟环境</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">conda create -n netops python=3.9.5</span><br></pre></td></tr></table></figure>



<h1 id="二、安装依赖"><a href="#二、安装依赖" class="headerlink" title="二、安装依赖"></a>二、安装依赖</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install -r requirements.txt</span><br></pre></td></tr></table></figure>



<h2 id="2-1-这一步安装报错如下："><a href="#2-1-这一步安装报错如下：" class="headerlink" title="2.1 这一步安装报错如下："></a>2.1 这一步安装报错如下：</h2><p><img src="/../pic/2024-4-18-netopscenter-2.png"></p>
<p>报错指出<code>mysql_config</code>和<code>mariadb_config</code>这两个命令在系统中未找到。<code>mysql_config</code>和<code>mariadb_config</code>是MySQL和MariaDB数据库的配置实用程序，用于提供编译和链接MySQL&#x2F;MariaDB客户端库时所需的编译选项和链接标志。Python包在安装时需要调用mysqlclient这些命令来获取正确的编译参数。</p>
<h2 id="2-2-解决方法："><a href="#2-2-解决方法：" class="headerlink" title="2.2 解决方法："></a>2.2 解决方法：</h2><p>要解决这个问题，您需要确保系统中已经安装了MySQL或MariaDB的开发库，并且<code>mysql_config</code>或<code>mariadb_config</code>命令可被找到。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">yum install mysql-devel</span><br><span class="line"><span class="comment"># ubuntu server下使用下面命令安装</span></span><br><span class="line"><span class="comment"># apt install libmysqlclient-dev</span></span><br></pre></td></tr></table></figure>

<h2 id="2-3-继续pip-安装依赖，还是有报错"><a href="#2-3-继续pip-安装依赖，还是有报错" class="headerlink" title="2.3 继续pip 安装依赖，还是有报错"></a>2.3 继续pip 安装依赖，还是有报错</h2><blockquote>
<p>error: command ‘gcc’ failed: No such file or directory<br>      [end of output]</p>
<p>  note: This error originates from a subprocess, and is likely not a problem with pip.<br>  ERROR: Failed building wheel for mysqlclient<br>  Running setup.py clean for mysqlclient<br>Failed to build mysqlclient<br>ERROR: Could not build wheels for mysqlclient, which is required to install pyproject.toml-based projects</p>
</blockquote>
<p>如下图，可以看出是缺少gcc之类的，yum安装即可</p>
<p><img src="/../pic/2024-4-18-netopscenter-3.png"></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">yum install gcc gcc-c++ make</span><br><span class="line"><span class="comment"># ubuntu server下使用下面命令安装</span></span><br><span class="line"><span class="comment"># apt install gcc</span></span><br></pre></td></tr></table></figure>

<h2 id="2-4-这下pip安装依赖就没问题了"><a href="#2-4-这下pip安装依赖就没问题了" class="headerlink" title="2.4 这下pip安装依赖就没问题了"></a>2.4 这下pip安装依赖就没问题了</h2><p><img src="/../pic/2024-4-18-netopscenter-4.png"></p>
<h1 id="四、数据库安装"><a href="#四、数据库安装" class="headerlink" title="四、数据库安装"></a>四、数据库安装</h1><p>代码应该是支持sqlite的，有兴趣的可以去代码里把mysql的注释掉，启用sqlite测试。我这里没有按照作者说明里在本地安装数据库，而是使用局域网一台群晖安装的mariaDB10套件测试。</p>
<p>注意之后需要在.&#x2F;netopscenter&#x2F;settings.py中修改相关数据库参数。</p>
<h2 id="4-1、套件安装"><a href="#4-1、套件安装" class="headerlink" title="4.1、套件安装"></a>4.1、套件安装</h2><p>略。</p>
<h2 id="4-2-数据库创建"><a href="#4-2-数据库创建" class="headerlink" title="4.2 数据库创建"></a>4.2 数据库创建</h2><p>ssh进入群晖，找到数据库安装路径&#x2F;volume3&#x2F;@appstore&#x2F;MariaDB10&#x2F;usr&#x2F;local&#x2F;mariadb10&#x2F;bin</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> /volume3/@appstore/MariaDB10/usr/local/mariadb10/bin</span><br><span class="line">./mysql -u root -p</span><br><span class="line"><span class="comment"># 以管理员身份进入数据库进行管理</span></span><br><span class="line">show databases;</span><br><span class="line"><span class="comment"># 查看已存在数据库</span></span><br><span class="line">drop database django;</span><br><span class="line"><span class="comment"># 把之前在windows下测试的django数据库删掉</span></span><br><span class="line">create database django;</span><br><span class="line"><span class="comment"># 重新创建django数据库用于服务</span></span><br><span class="line">use django;</span><br><span class="line"><span class="comment"># 选择django数据库</span></span><br><span class="line">grant all on django.* TO <span class="string">&#x27;django&#x27;</span>@<span class="string">&#x27;localhost&#x27;</span> identified by <span class="string">&#x27;Suyu123!@#&#x27;</span>;</span><br><span class="line"><span class="comment"># 向MySQL数据库中授予特定用户对特定数据库的全部权限，并且指定了用户的登录凭据</span></span><br><span class="line">ALTER DATABASE django DEFAULT CHARACTER SET utf8mb4 COLLATE utf8mb4_general_ci;</span><br><span class="line"><span class="comment"># 修改数据库编码，解决中文乱码问题</span></span><br></pre></td></tr></table></figure>

<h1 id="五、拉取项目并修改-netopscenter-settings-py"><a href="#五、拉取项目并修改-netopscenter-settings-py" class="headerlink" title="五、拉取项目并修改.&#x2F;netopscenter&#x2F;settings.py"></a>五、拉取项目并修改.&#x2F;netopscenter&#x2F;settings.py</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git <span class="built_in">clone</span> https://github.com/XiuziSeven/NetOpsCenter.git</span><br></pre></td></tr></table></figure>

<p>找到数据库配置代码，修改数据库名及连接用户名、密码、数据库地址。</p>
<h1 id="六、初始化数据库"><a href="#六、初始化数据库" class="headerlink" title="六、初始化数据库"></a>六、初始化数据库</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">python manage.py makemigrations app</span><br><span class="line">python manage.py migrate</span><br></pre></td></tr></table></figure>



<h2 id="6-1makemigrations-app命令报错"><a href="#6-1makemigrations-app命令报错" class="headerlink" title="6.1makemigrations app命令报错"></a>6.1makemigrations app命令报错</h2><h3 id="6-1-1-报错内容如下"><a href="#6-1-1-报错内容如下" class="headerlink" title="6.1.1 报错内容如下"></a>6.1.1 报错内容如下</h3><blockquote>
<p>d:\miniconda3\envs\NetOpsCenter\lib\site-packages\django\core\management\commands\makemigrations.py:121: RuntimeWarning: Got an error checking a consistent migration history performed for database connection ‘default’: (1130, “Host ‘10.139.27.5’ is not allowed to connect to this MariaDB server”)<br>  warnings.warn(<br>Migrations for ‘app’:<br>  app\migrations\0001_initial.py</p>
<ul>
<li>Create model Area</li>
<li>Create model DeviceBrand</li>
<li>Create model Devices</li>
<li>Create model DeviceType</li>
<li>Create model DeviceUser</li>
<li>Create model Task</li>
<li>Create model DevicesGroup</li>
<li>Add field device_type to devices</li>
<li>Add field device_user to devices</li>
<li>Create model NewUser</li>
</ul>
</blockquote>
<p> 这个错误表示: MySQL中的用户权限信息通常存储在系统数据库 mysql 中的 user 表中，而不是在您自定义的数据库（如django）中。错误信息中的表名 django.user 似乎暗示您试图在 django 数据库中查找用户表，但实际上应该是在 mysql 数据库中。</p>
<p>主要原因是运行程序设备ip不是数据库服务器信任地址。</p>
<h3 id="6-1-2-解决方案"><a href="#6-1-2-解决方案" class="headerlink" title="6.1.2 解决方案"></a>6.1.2 解决方案</h3><p>更正 UPDATE 语句，使其指向正确的表。对于修改用户权限，正确的数据库操作命令应该是：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">UPDATE mysql.user SET host = <span class="string">&#x27;10.139.27.%&#x27;</span> WHERE User = <span class="string">&#x27;django&#x27;</span>;</span><br><span class="line">FLUSH PRIVILEGES;</span><br></pre></td></tr></table></figure>

<p>注意：</p>
<p>10.139.27.%表示10.139.27.0&#x2F;24段子网</p>
<p>使用 mysql.user 表示系统数据库 mysql 中的 user 表。<br>使用 User 而不是 user，因为在 mysql.user 表中，用户名字段的列名是 User（首字母大写）。</p>
<blockquote>
<p>MariaDB [django]&gt; UPDATE mysql.user SET host &#x3D; ‘10.139.27.%’ WHERE User &#x3D; ‘django’;<br>Query OK, 1 row affected (0.000 sec)<br>Rows matched: 1  Changed: 1  Warnings: </p>
</blockquote>
<h3 id="6-1-3-python运行还是报错，回到数据库中继续给权限"><a href="#6-1-3-python运行还是报错，回到数据库中继续给权限" class="headerlink" title="6.1.3 python运行还是报错，回到数据库中继续给权限"></a>6.1.3 python运行还是报错，回到数据库中继续给权限</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">GRANT ALL PRIVILEGES ON django.* TO <span class="string">&#x27;django&#x27;</span>@<span class="string">&#x27;10.139.27.%&#x27;</span>;</span><br><span class="line">FLUSH PRIVILEGES;</span><br></pre></td></tr></table></figure>

<h3 id="6-1-4-重新执行数据库初始化，均无报错了"><a href="#6-1-4-重新执行数据库初始化，均无报错了" class="headerlink" title="6.1.4 重新执行数据库初始化，均无报错了"></a>6.1.4 重新执行数据库初始化，均无报错了</h3><p>(NetOpsCenter) E:\pythoncode\NetOpsCenter&gt;python manage.py makemigrations app<br>No changes detected in app ‘app’<br>python manage.py migrate #无报错</p>
<h1 id="七、创建默认管理员账号"><a href="#七、创建默认管理员账号" class="headerlink" title="七、创建默认管理员账号"></a>七、创建默认管理员账号</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">python manage.py createsuperuser <span class="comment">#创建管理员</span></span><br><span class="line">python manage.py <span class="built_in">help</span>  <span class="comment">#帮助</span></span><br></pre></td></tr></table></figure>

<p>有个天坑，是我在windows下测试发现的。</p>
<p>1、密码不能小于6位，且要有字母，否则无法登陆。</p>
<p>2、用户名必须是admin，其他用户名提示用户名无效。（登录后发现所创建用户都能看到，说明创建成功了，但是就是不能登录）</p>
<p>是否个例需要大家测试。</p>
<p>2024-5-22：实际上在linux（ubuntu22）下测试也是同样问题，大家小心。</p>
<h1 id="八、运行服务"><a href="#八、运行服务" class="headerlink" title="八、运行服务"></a>八、运行服务</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python manage.py runserver 0.0.0.0:8000</span><br></pre></td></tr></table></figure>

<h1 id="九、其他"><a href="#九、其他" class="headerlink" title="九、其他"></a>九、其他</h1><h2 id="9-1-防火墙放行"><a href="#9-1-防火墙放行" class="headerlink" title="9.1 防火墙放行"></a>9.1 防火墙放行</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">firewall-cmd --permanent --add-port=8000/tcp</span><br><span class="line">firewall-cmd --reload</span><br><span class="line">firewall-cmd --list-ports</span><br></pre></td></tr></table></figure>

<h2 id="9-2-ubuntu下手动执行脚本启动服务"><a href="#9-2-ubuntu下手动执行脚本启动服务" class="headerlink" title="9.2 ubuntu下手动执行脚本启动服务"></a>9.2 ubuntu下手动执行脚本启动服务</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"><span class="comment"># 等效于@echo off，关闭命令回显，我不确认是否有效，阿里ai给的</span></span><br><span class="line"><span class="built_in">exec</span> &amp;&gt;/dev/null</span><br><span class="line"><span class="comment"># 使用conda激活miniconda3环境，可以先用conda info命令确认路径</span></span><br><span class="line"><span class="built_in">source</span> /home/bg4vrg/miniconda3/bin/activate /home/bg4vrg/miniconda3/envs/netopscenter</span><br><span class="line"><span class="comment"># 更改工作目录到NetOpsCenter目录</span></span><br><span class="line"><span class="built_in">cd</span> /home/bg4vrg/NetOpsCenter</span><br><span class="line"><span class="comment"># 运行python manage.py命令</span></span><br><span class="line">python manage.py runserver 0.0.0.0:8000</span><br></pre></td></tr></table></figure>

<p>注意ubuntu下要使用<code>/bin/bash netopscenter.sh</code>执行脚本，因为ubuntu和centos不同，默认解释器是dash。</p>
<h2 id="9-2-1-ubuntu下创建服务开机自启动"><a href="#9-2-1-ubuntu下创建服务开机自启动" class="headerlink" title="9.2.1 ubuntu下创建服务开机自启动"></a>9.2.1 ubuntu下创建服务开机自启动</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#新增服务，名称为netopscenter</span></span><br><span class="line">sudo nano /etc/systemd/system/netopscenter.service</span><br><span class="line"><span class="comment"># 启用激活netopscenter服务</span></span><br><span class="line">sudo systemctl <span class="built_in">enable</span> netopscenter.service</span><br><span class="line"><span class="comment"># 启动netopscenter服务</span></span><br><span class="line">sudo systemctl start netopscenter.service</span><br><span class="line"><span class="comment"># 查看netopscenter服务状态</span></span><br><span class="line">sudo systemctl status netopscenter.service</span><br><span class="line"><span class="comment"># 查看服务日志</span></span><br><span class="line">sudo journalctl -u netopscenter.service</span><br></pre></td></tr></table></figure>

<p>上面&#x2F;etc&#x2F;systemd&#x2F;system&#x2F;netopscenter.service内容如下</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">[Unit]</span><br><span class="line">Description=NetOpsCenter Startup Script</span><br><span class="line">After=network.target</span><br><span class="line"></span><br><span class="line">[Service]</span><br><span class="line">User=root</span><br><span class="line">ExecStart=/bin/bash -c <span class="string">&#x27;/home/bg4vrg/netopscenter.sh&#x27;</span></span><br><span class="line">Restart=on-failure</span><br><span class="line">RestartSec=50  <span class="comment"># 重启间隔，单位为秒</span></span><br><span class="line"></span><br><span class="line">[Install]</span><br><span class="line">WantedBy=multi-user.target</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><code>/bin/bash -c &#39;/home/bg4vrg/netopscenter.sh&#39;</code></p>
<p>这里，<code>/bin/bash -c</code>表示使用bash解释器执行紧跟其后的命令字符串</p>
<p>重启，检查服务生效。</p>
</div><div class="article-licensing box"><div class="licensing-title"><p>基于vue+django开发的网络设备轻量化管理平台NetOpsCenter</p><p><a href="https://bg4vrg.com/post/20240418192744.html">https://bg4vrg.com/post/20240418192744.html</a></p></div><div class="licensing-meta level is-mobile"><div class="level-left"><div class="level-item is-narrow"><div><h6>作者</h6><p>fei</p></div></div><div class="level-item is-narrow"><div><h6>发布于</h6><p>2024-04-18</p></div></div><div class="level-item is-narrow"><div><h6>更新于</h6><p>2024-05-22</p></div></div><div class="level-item is-narrow"><div><h6>许可协议</h6><p><a class="icons" rel="external nofollow noopener noreferrer" target="_blank" title="Creative Commons" href="https://creativecommons.org/"><i class="icon fab fa-creative-commons"></i></a><a class="icons" rel="external nofollow noopener noreferrer" target="_blank" title="Attribution" href="https://creativecommons.org/licenses/by/4.0/"><i class="icon fab fa-creative-commons-by"></i></a><a class="icons" rel="external nofollow noopener noreferrer" target="_blank" title="Noncommercial" href="https://creativecommons.org/licenses/by-nc/4.0/"><i class="icon fab fa-creative-commons-nc"></i></a></p></div></div></div></div></div><div class="article-tags is-size-7 mb-4"><span class="mr-2">#</span><a class="link-muted mr-2" rel="tag" href="/tags/%E7%BD%91%E7%BB%9C/">网络</a><a class="link-muted mr-2" rel="tag" href="/tags/%E6%8A%98%E8%85%BE/">折腾</a><a class="link-muted mr-2" rel="tag" href="/tags/linux/">linux</a></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js@1.0.16/dist/css/share.min.css"><div class="social-share"></div><script src="https://cdn.jsdelivr.net/npm/social-share.js@1.0.16/dist/js/social-share.min.js"></script></article></div><div class="card"><div class="card-content"><h3 class="menu-label has-text-centered">喜欢这篇文章？打赏一下作者吧</h3><div class="buttons is-centered"><a class="button donate" data-type="alipay"><span class="icon is-small"><i class="fab fa-alipay"></i></span><span>支付宝</span><span class="qrcode"><img src="/img/alipay.png" alt="支付宝"></span></a><a class="button donate" data-type="wechat"><span class="icon is-small"><i class="fab fa-weixin"></i></span><span>微信</span><span class="qrcode"><img src="/img/wechatpay.png" alt="微信"></span></a></div></div></div><nav class="post-navigation mt-4 level is-mobile"><div class="level-start"><a class="article-nav-prev level level-item link-muted" href="/post/20240421204758.html"><i class="level-item fas fa-chevron-left"></i><span class="level-item">CsiR大佬新作NetOpsGUI:netops2.0的图形版</span></a></div><div class="level-end"><a class="article-nav-next level level-item link-muted" href="/post/20240418164858.html"><span class="level-item">centos7安装miniconda3</span><i class="level-item fas fa-chevron-right"></i></a></div></nav><div class="card"><div class="card-content"><h3 class="title is-5">评论</h3><div id="disqus_thread"><noscript>Please enable JavaScript to view the <a target="_blank" rel="noopener" href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript></div><script>var disqus_config = function () {
            this.page.url = 'https://bg4vrg.com/post/20240418192744.html';
            this.page.identifier = 'post/20240418192744.html';
        };
        (function() {
            var d = document, s = d.createElement('script');  
            s.src = '//' + 'bg4vrg' + '.disqus.com/embed.js';
            s.setAttribute('data-timestamp', +new Date());
            (d.head || d.body).appendChild(s);
        })();</script></div></div></div><div class="column column-left is-4-tablet is-4-desktop is-3-widescreen  order-1"><div class="card widget" data-type="recent-posts"><div class="card-content"><h3 class="menu-label">最新文章</h3><article class="media"><div class="media-content"><p class="date"><time datetime="2024-06-04T09:47:05.000Z">2024-06-04</time></p><p class="title"><a href="/post/20240604174705.html">迁移transmission数据到新建服务器</a></p><p class="categories"><a href="/categories/linux/">linux</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time datetime="2024-06-02T08:04:03.000Z">2024-06-02</time></p><p class="title"><a href="/post/20240602160403.html">rsync免密码传输</a></p><p class="categories"><a href="/categories/linux/">linux</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time datetime="2024-05-30T07:55:58.000Z">2024-05-30</time></p><p class="title"><a href="/post/20240530155558.html">unraid中部分硬盘无法休眠</a></p><p class="categories"><a href="/categories/linux/">linux</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time datetime="2024-05-22T05:07:44.000Z">2024-05-22</time></p><p class="title"><a href="/post/20240522130744.html">廉价业余无线电收发套件ADX-S v2</a></p><p class="categories"><a href="/categories/AmateurRadio/">业余无线电</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time datetime="2024-04-21T12:47:58.000Z">2024-04-21</time></p><p class="title"><a href="/post/20240421204758.html">CsiR大佬新作NetOpsGUI:netops2.0的图形版</a></p><p class="categories"><a href="/categories/network/">网络</a></p></div></article></div></div><div class="card widget" data-type="categories"><div class="card-content"><div class="menu"><h3 class="menu-label">分类</h3><ul class="menu-list"><li><a class="level is-mobile" href="/categories/linux/"><span class="level-start"><span class="level-item">linux</span></span><span class="level-end"><span class="level-item tag">22</span></span></a></li><li><a class="level is-mobile" href="/categories/AmateurRadio/"><span class="level-start"><span class="level-item">业余无线电</span></span><span class="level-end"><span class="level-item tag">40</span></span></a></li><li><a class="level is-mobile" href="/categories/network/"><span class="level-start"><span class="level-item">网络</span></span><span class="level-end"><span class="level-item tag">9</span></span></a></li><li><a class="level is-mobile" href="/categories/note/"><span class="level-start"><span class="level-item">记录</span></span><span class="level-end"><span class="level-item tag">21</span></span></a></li></ul></div></div></div><div class="card widget" id="toc" data-type="toc"><div class="card-content"><div class="menu"><h3 class="menu-label">目录</h3><ul class="menu-list"><li><a class="level is-mobile" href="#一、创建虚拟环境"><span class="level-left"><span class="level-item">一、创建虚拟环境</span></span></a></li><li><a class="level is-mobile" href="#二、安装依赖"><span class="level-left"><span class="level-item">二、安装依赖</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#2-1-这一步安装报错如下："><span class="level-left"><span class="level-item">2.1 这一步安装报错如下：</span></span></a></li><li><a class="level is-mobile" href="#2-2-解决方法："><span class="level-left"><span class="level-item">2.2 解决方法：</span></span></a></li><li><a class="level is-mobile" href="#2-3-继续pip-安装依赖，还是有报错"><span class="level-left"><span class="level-item">2.3 继续pip 安装依赖，还是有报错</span></span></a></li><li><a class="level is-mobile" href="#2-4-这下pip安装依赖就没问题了"><span class="level-left"><span class="level-item">2.4 这下pip安装依赖就没问题了</span></span></a></li></ul></li><li><a class="level is-mobile" href="#四、数据库安装"><span class="level-left"><span class="level-item">四、数据库安装</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#4-1、套件安装"><span class="level-left"><span class="level-item">4.1、套件安装</span></span></a></li><li><a class="level is-mobile" href="#4-2-数据库创建"><span class="level-left"><span class="level-item">4.2 数据库创建</span></span></a></li></ul></li><li><a class="level is-mobile" href="#五、拉取项目并修改-netopscenter-settings-py"><span class="level-left"><span class="level-item">五、拉取项目并修改./netopscenter/settings.py</span></span></a></li><li><a class="level is-mobile" href="#六、初始化数据库"><span class="level-left"><span class="level-item">六、初始化数据库</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#6-1makemigrations-app命令报错"><span class="level-left"><span class="level-item">6.1makemigrations app命令报错</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#6-1-1-报错内容如下"><span class="level-left"><span class="level-item">6.1.1 报错内容如下</span></span></a></li><li><a class="level is-mobile" href="#6-1-2-解决方案"><span class="level-left"><span class="level-item">6.1.2 解决方案</span></span></a></li><li><a class="level is-mobile" href="#6-1-3-python运行还是报错，回到数据库中继续给权限"><span class="level-left"><span class="level-item">6.1.3 python运行还是报错，回到数据库中继续给权限</span></span></a></li><li><a class="level is-mobile" href="#6-1-4-重新执行数据库初始化，均无报错了"><span class="level-left"><span class="level-item">6.1.4 重新执行数据库初始化，均无报错了</span></span></a></li></ul></li></ul></li><li><a class="level is-mobile" href="#七、创建默认管理员账号"><span class="level-left"><span class="level-item">七、创建默认管理员账号</span></span></a></li><li><a class="level is-mobile" href="#八、运行服务"><span class="level-left"><span class="level-item">八、运行服务</span></span></a></li><li><a class="level is-mobile" href="#九、其他"><span class="level-left"><span class="level-item">九、其他</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#9-1-防火墙放行"><span class="level-left"><span class="level-item">9.1 防火墙放行</span></span></a></li><li><a class="level is-mobile" href="#9-2-ubuntu下手动执行脚本启动服务"><span class="level-left"><span class="level-item">9.2 ubuntu下手动执行脚本启动服务</span></span></a></li><li><a class="level is-mobile" href="#9-2-1-ubuntu下创建服务开机自启动"><span class="level-left"><span class="level-item">9.2.1 ubuntu下创建服务开机自启动</span></span></a></li></ul></li></ul></div></div><style>#toc .menu-list > li > a.is-active + .menu-list { display: block; }#toc .menu-list > li > a + .menu-list { display: none; }</style><script src="/js/toc.js" defer></script></div><div class="card widget" data-type="adsense"><div class="card-content"><div class="menu"><h3 class="menu-label">广告</h3><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-1305232905963539" data-ad-slot="5679527426" data-ad-format="auto" data-full-width-responsive="true"></ins><script>(adsbygoogle = window.adsbygoogle || []).push({});</script></div></div></div></div><!--!--></div></div><br></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="/"><img src="/img/freebsd.svg" alt="BG4VRG的无线电之旅" height="28"></a><p class="is-size-7"><span>&copy; 2024 fei</span>  Powered by <a href="https://hexo.io/" target="_blank" rel="external nofollow noopener noreferrer">Hexo</a> &amp; <a href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank" rel="external nofollow noopener noreferrer">Icarus</a><br><span id="timeDate">载入天数...</span><span id="times">载入时分秒...</span><script>
        var now = new Date();
        function createtime() {
            var grt= new Date("10/24/2015 00:00:00");//此处修改你的建站时间或者网站上线时间
            now.setTime(now.getTime()+250);
            days = (now - grt ) / 1000 / 60 / 60 / 24; dnum = Math.floor(days);
            hours = (now - grt ) / 1000 / 60 / 60 - (24 * dnum); hnum = Math.floor(hours);
            if(String(hnum).length ==1 ){hnum = "0" + hnum;} minutes = (now - grt ) / 1000 /60 - (24 * 60 * dnum) - (60 * hnum);
            mnum = Math.floor(minutes); if(String(mnum).length ==1 ){mnum = "0" + mnum;}
            seconds = (now - grt ) / 1000 - (24 * 60 * 60 * dnum) - (60 * 60 * hnum) - (60 * mnum);
            snum = Math.round(seconds); if(String(snum).length ==1 ){snum = "0" + snum;}
            document.getElementById("timeDate").innerHTML = "| 本站已运行 "+dnum+" 天 ";
            document.getElementById("times").innerHTML = hnum + " 小时 " + mnum + " 分 " + snum + " 秒";
        }
        setInterval("createtime()",250);
        </script><br><span id="busuanzi_container_site_uv">共<span id="busuanzi_value_site_uv">0</span>个访客</span><span> | </span><span id="busuanzi_container_site_pv">总访问量<span id="busuanzi_value_site_pv">0</span></span></p></div><div class="level-end"><div class="field has-addons"><p class="control"><a class="button is-transparent is-large" target="_blank" rel="external nofollow noopener noreferrer" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="external nofollow noopener noreferrer" title="Attribution 4.0 International" href="https://creativecommons.org/licenses/by/4.0/"><i class="fab fa-creative-commons-by"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="external nofollow noopener noreferrer" title="Download on GitHub" href="https://github.com/ppoffice/hexo-theme-icarus"><i class="fab fa-github"></i></a></p></div></div></div></div></footer><script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script><script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js" defer></script><script>moment.locale("zh-cn");</script><script>var IcarusThemeSettings = {
            article: {
                highlight: {
                    clipboard: true,
                    fold: 'unfolded'
                }
            }
        };</script><script src="/js/column.js"></script><script src="/js/animation.js"></script><a id="back-to-top" title="回到顶端" href="javascript:;" rel="external nofollow noreferrer"><i class="fas fa-chevron-up"></i></a><script src="/js/back_to_top.js" defer></script><!--!--><!--!--><!--!--><script src="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.js" defer></script><script>window.addEventListener("load", () => {
      window.cookieconsent.initialise({
        type: "info",
        theme: "edgeless",
        static: false,
        position: "bottom-left",
        content: {
          message: "此网站使用Cookie来改善您的体验。",
          dismiss: "知道了！",
          allow: "允许使用Cookie",
          deny: "拒绝",
          link: "了解更多",
          policy: "Cookie政策",
          href: "https://www.cookiesandyou.com/",
        },
        palette: {
          popup: {
            background: "#edeff5",
            text: "#838391"
          },
          button: {
            background: "#4b81e8"
          },
        },
      });
    });</script><script src="https://cdn.jsdelivr.net/npm/lightgallery@1.10.0/dist/js/lightgallery.min.js" defer></script><script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.8.1/dist/js/jquery.justifiedGallery.min.js" defer></script><script>window.addEventListener("load", () => {
            if (typeof $.fn.lightGallery === 'function') {
                $('.article').lightGallery({ selector: '.gallery-item' });
            }
            if (typeof $.fn.justifiedGallery === 'function') {
                if ($('.justified-gallery > p > .gallery-item').length) {
                    $('.justified-gallery > p > .gallery-item').unwrap();
                }
                $('.justified-gallery').justifiedGallery();
            }
        });</script><!--!--><!--!--><!--!--><!--!--><!--!--><script src="/js/main.js" defer></script><div class="searchbox"><div class="searchbox-container"><div class="searchbox-header"><div class="searchbox-input-container"><input class="searchbox-input" type="text" placeholder="想要查找什么..."></div><a class="searchbox-close" href="javascript:;" rel="external nofollow noreferrer">×</a></div><div class="searchbox-body"></div></div></div><script src="/js/insight.js" defer></script><script>document.addEventListener('DOMContentLoaded', function () {
            loadInsight({"contentUrl":"/content.json"}, {"hint":"想要查找什么...","untitled":"(无标题)","posts":"文章","pages":"页面","categories":"分类","tags":"标签"});
        });</script></body></html>